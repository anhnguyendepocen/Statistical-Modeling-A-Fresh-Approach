<!DOCTYPE html>
<!-- saved from url=(0014)about:internet -->
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>

<title>Stats 155 Class Notes 2012-10-05</title>

<base target="_blank"/>

<style type="text/css">
body, td {
   font-family: sans-serif;
   background-color: white;
   font-size: 12px;
   margin: 8px;
}

tt, code, pre {
   font-family: 'DejaVu Sans Mono', 'Droid Sans Mono', 'Lucida Console', Consolas, Monaco, monospace;
}

h1 { 
   font-size:2.2em; 
}

h2 { 
   font-size:1.8em; 
}

h3 { 
   font-size:1.4em; 
}

h4 { 
   font-size:1.0em; 
}

h5 { 
   font-size:0.9em; 
}

h6 { 
   font-size:0.8em; 
}

a:visited {
   color: rgb(50%, 0%, 50%);
}

pre {	
   margin-top: 0;
   max-width: 95%;
   border: 1px solid #ccc;
}

pre code {
   display: block; padding: 0.5em;
}

code.r {
   background-color: #F8F8F8;
}

table, td, th {
  border: none;
}

blockquote {
   color:#666666;
   margin:0;
   padding-left: 1em;
   border-left: 0.5em #EEE solid;
}

hr {
   height: 0px;
   border-bottom: none;
   border-top-width: thin;
   border-top-style: dotted;
   border-top-color: #999999;
}

@media print {
   * { 
      background: transparent !important; 
      color: black !important; 
      filter:none !important; 
      -ms-filter: none !important; 
   }

   body { 
      font-size:12pt; 
      max-width:100%; 
   }
       
   a, a:visited { 
      text-decoration: underline; 
   }

   hr { 
      visibility: hidden;
      page-break-before: always;
   }

   pre, blockquote { 
      padding-right: 1em; 
      page-break-inside: avoid; 
   }

   tr, img { 
      page-break-inside: avoid; 
   }

   img { 
      max-width: 100% !important; 
   }

   @page :left { 
      margin: 15mm 20mm 15mm 10mm; 
   }
     
   @page :right { 
      margin: 15mm 10mm 15mm 20mm; 
   }

   p, h2, h3 { 
      orphans: 3; widows: 3; 
   }

   h2, h3 { 
      page-break-after: avoid; 
   }
}

</style>

<!-- Styles for R syntax highlighter -->
<style type="text/css">
   pre .operator,
   pre .paren {
     color: rgb(104, 118, 135)
   }

   pre .literal {
     color: rgb(88, 72, 246)
   }

   pre .number {
     color: rgb(0, 0, 205);
   }

   pre .comment {
     color: rgb(76, 136, 107);
   }

   pre .keyword {
     color: rgb(0, 0, 255);
   }

   pre .identifier {
     color: rgb(0, 0, 0);
   }

   pre .string {
     color: rgb(3, 106, 7);
   }
</style>

<!-- R syntax highlighter -->
<script type="text/javascript">
var hljs=new function(){function m(p){return p.replace(/&/gm,"&amp;").replace(/</gm,"&lt;")}function f(r,q,p){return RegExp(q,"m"+(r.cI?"i":"")+(p?"g":""))}function b(r){for(var p=0;p<r.childNodes.length;p++){var q=r.childNodes[p];if(q.nodeName=="CODE"){return q}if(!(q.nodeType==3&&q.nodeValue.match(/\s+/))){break}}}function h(t,s){var p="";for(var r=0;r<t.childNodes.length;r++){if(t.childNodes[r].nodeType==3){var q=t.childNodes[r].nodeValue;if(s){q=q.replace(/\n/g,"")}p+=q}else{if(t.childNodes[r].nodeName=="BR"){p+="\n"}else{p+=h(t.childNodes[r])}}}if(/MSIE [678]/.test(navigator.userAgent)){p=p.replace(/\r/g,"\n")}return p}function a(s){var r=s.className.split(/\s+/);r=r.concat(s.parentNode.className.split(/\s+/));for(var q=0;q<r.length;q++){var p=r[q].replace(/^language-/,"");if(e[p]){return p}}}function c(q){var p=[];(function(s,t){for(var r=0;r<s.childNodes.length;r++){if(s.childNodes[r].nodeType==3){t+=s.childNodes[r].nodeValue.length}else{if(s.childNodes[r].nodeName=="BR"){t+=1}else{if(s.childNodes[r].nodeType==1){p.push({event:"start",offset:t,node:s.childNodes[r]});t=arguments.callee(s.childNodes[r],t);p.push({event:"stop",offset:t,node:s.childNodes[r]})}}}}return t})(q,0);return p}function k(y,w,x){var q=0;var z="";var s=[];function u(){if(y.length&&w.length){if(y[0].offset!=w[0].offset){return(y[0].offset<w[0].offset)?y:w}else{return w[0].event=="start"?y:w}}else{return y.length?y:w}}function t(D){var A="<"+D.nodeName.toLowerCase();for(var B=0;B<D.attributes.length;B++){var C=D.attributes[B];A+=" "+C.nodeName.toLowerCase();if(C.value!==undefined&&C.value!==false&&C.value!==null){A+='="'+m(C.value)+'"'}}return A+">"}while(y.length||w.length){var v=u().splice(0,1)[0];z+=m(x.substr(q,v.offset-q));q=v.offset;if(v.event=="start"){z+=t(v.node);s.push(v.node)}else{if(v.event=="stop"){var p,r=s.length;do{r--;p=s[r];z+=("</"+p.nodeName.toLowerCase()+">")}while(p!=v.node);s.splice(r,1);while(r<s.length){z+=t(s[r]);r++}}}}return z+m(x.substr(q))}function j(){function q(x,y,v){if(x.compiled){return}var u;var s=[];if(x.k){x.lR=f(y,x.l||hljs.IR,true);for(var w in x.k){if(!x.k.hasOwnProperty(w)){continue}if(x.k[w] instanceof Object){u=x.k[w]}else{u=x.k;w="keyword"}for(var r in u){if(!u.hasOwnProperty(r)){continue}x.k[r]=[w,u[r]];s.push(r)}}}if(!v){if(x.bWK){x.b="\\b("+s.join("|")+")\\s"}x.bR=f(y,x.b?x.b:"\\B|\\b");if(!x.e&&!x.eW){x.e="\\B|\\b"}if(x.e){x.eR=f(y,x.e)}}if(x.i){x.iR=f(y,x.i)}if(x.r===undefined){x.r=1}if(!x.c){x.c=[]}x.compiled=true;for(var t=0;t<x.c.length;t++){if(x.c[t]=="self"){x.c[t]=x}q(x.c[t],y,false)}if(x.starts){q(x.starts,y,false)}}for(var p in e){if(!e.hasOwnProperty(p)){continue}q(e[p].dM,e[p],true)}}function d(B,C){if(!j.called){j();j.called=true}function q(r,M){for(var L=0;L<M.c.length;L++){if((M.c[L].bR.exec(r)||[null])[0]==r){return M.c[L]}}}function v(L,r){if(D[L].e&&D[L].eR.test(r)){return 1}if(D[L].eW){var M=v(L-1,r);return M?M+1:0}return 0}function w(r,L){return L.i&&L.iR.test(r)}function K(N,O){var M=[];for(var L=0;L<N.c.length;L++){M.push(N.c[L].b)}var r=D.length-1;do{if(D[r].e){M.push(D[r].e)}r--}while(D[r+1].eW);if(N.i){M.push(N.i)}return f(O,M.join("|"),true)}function p(M,L){var N=D[D.length-1];if(!N.t){N.t=K(N,E)}N.t.lastIndex=L;var r=N.t.exec(M);return r?[M.substr(L,r.index-L),r[0],false]:[M.substr(L),"",true]}function z(N,r){var L=E.cI?r[0].toLowerCase():r[0];var M=N.k[L];if(M&&M instanceof Array){return M}return false}function F(L,P){L=m(L);if(!P.k){return L}var r="";var O=0;P.lR.lastIndex=0;var M=P.lR.exec(L);while(M){r+=L.substr(O,M.index-O);var N=z(P,M);if(N){x+=N[1];r+='<span class="'+N[0]+'">'+M[0]+"</span>"}else{r+=M[0]}O=P.lR.lastIndex;M=P.lR.exec(L)}return r+L.substr(O,L.length-O)}function J(L,M){if(M.sL&&e[M.sL]){var r=d(M.sL,L);x+=r.keyword_count;return r.value}else{return F(L,M)}}function I(M,r){var L=M.cN?'<span class="'+M.cN+'">':"";if(M.rB){y+=L;M.buffer=""}else{if(M.eB){y+=m(r)+L;M.buffer=""}else{y+=L;M.buffer=r}}D.push(M);A+=M.r}function G(N,M,Q){var R=D[D.length-1];if(Q){y+=J(R.buffer+N,R);return false}var P=q(M,R);if(P){y+=J(R.buffer+N,R);I(P,M);return P.rB}var L=v(D.length-1,M);if(L){var O=R.cN?"</span>":"";if(R.rE){y+=J(R.buffer+N,R)+O}else{if(R.eE){y+=J(R.buffer+N,R)+O+m(M)}else{y+=J(R.buffer+N+M,R)+O}}while(L>1){O=D[D.length-2].cN?"</span>":"";y+=O;L--;D.length--}var r=D[D.length-1];D.length--;D[D.length-1].buffer="";if(r.starts){I(r.starts,"")}return R.rE}if(w(M,R)){throw"Illegal"}}var E=e[B];var D=[E.dM];var A=0;var x=0;var y="";try{var s,u=0;E.dM.buffer="";do{s=p(C,u);var t=G(s[0],s[1],s[2]);u+=s[0].length;if(!t){u+=s[1].length}}while(!s[2]);if(D.length>1){throw"Illegal"}return{r:A,keyword_count:x,value:y}}catch(H){if(H=="Illegal"){return{r:0,keyword_count:0,value:m(C)}}else{throw H}}}function g(t){var p={keyword_count:0,r:0,value:m(t)};var r=p;for(var q in e){if(!e.hasOwnProperty(q)){continue}var s=d(q,t);s.language=q;if(s.keyword_count+s.r>r.keyword_count+r.r){r=s}if(s.keyword_count+s.r>p.keyword_count+p.r){r=p;p=s}}if(r.language){p.second_best=r}return p}function i(r,q,p){if(q){r=r.replace(/^((<[^>]+>|\t)+)/gm,function(t,w,v,u){return w.replace(/\t/g,q)})}if(p){r=r.replace(/\n/g,"<br>")}return r}function n(t,w,r){var x=h(t,r);var v=a(t);var y,s;if(v){y=d(v,x)}else{return}var q=c(t);if(q.length){s=document.createElement("pre");s.innerHTML=y.value;y.value=k(q,c(s),x)}y.value=i(y.value,w,r);var u=t.className;if(!u.match("(\\s|^)(language-)?"+v+"(\\s|$)")){u=u?(u+" "+v):v}if(/MSIE [678]/.test(navigator.userAgent)&&t.tagName=="CODE"&&t.parentNode.tagName=="PRE"){s=t.parentNode;var p=document.createElement("div");p.innerHTML="<pre><code>"+y.value+"</code></pre>";t=p.firstChild.firstChild;p.firstChild.cN=s.cN;s.parentNode.replaceChild(p.firstChild,s)}else{t.innerHTML=y.value}t.className=u;t.result={language:v,kw:y.keyword_count,re:y.r};if(y.second_best){t.second_best={language:y.second_best.language,kw:y.second_best.keyword_count,re:y.second_best.r}}}function o(){if(o.called){return}o.called=true;var r=document.getElementsByTagName("pre");for(var p=0;p<r.length;p++){var q=b(r[p]);if(q){n(q,hljs.tabReplace)}}}function l(){if(window.addEventListener){window.addEventListener("DOMContentLoaded",o,false);window.addEventListener("load",o,false)}else{if(window.attachEvent){window.attachEvent("onload",o)}else{window.onload=o}}}var e={};this.LANGUAGES=e;this.highlight=d;this.highlightAuto=g;this.fixMarkup=i;this.highlightBlock=n;this.initHighlighting=o;this.initHighlightingOnLoad=l;this.IR="[a-zA-Z][a-zA-Z0-9_]*";this.UIR="[a-zA-Z_][a-zA-Z0-9_]*";this.NR="\\b\\d+(\\.\\d+)?";this.CNR="\\b(0[xX][a-fA-F0-9]+|(\\d+(\\.\\d*)?|\\.\\d+)([eE][-+]?\\d+)?)";this.BNR="\\b(0b[01]+)";this.RSR="!|!=|!==|%|%=|&|&&|&=|\\*|\\*=|\\+|\\+=|,|\\.|-|-=|/|/=|:|;|<|<<|<<=|<=|=|==|===|>|>=|>>|>>=|>>>|>>>=|\\?|\\[|\\{|\\(|\\^|\\^=|\\||\\|=|\\|\\||~";this.ER="(?![\\s\\S])";this.BE={b:"\\\\.",r:0};this.ASM={cN:"string",b:"'",e:"'",i:"\\n",c:[this.BE],r:0};this.QSM={cN:"string",b:'"',e:'"',i:"\\n",c:[this.BE],r:0};this.CLCM={cN:"comment",b:"//",e:"$"};this.CBLCLM={cN:"comment",b:"/\\*",e:"\\*/"};this.HCM={cN:"comment",b:"#",e:"$"};this.NM={cN:"number",b:this.NR,r:0};this.CNM={cN:"number",b:this.CNR,r:0};this.BNM={cN:"number",b:this.BNR,r:0};this.inherit=function(r,s){var p={};for(var q in r){p[q]=r[q]}if(s){for(var q in s){p[q]=s[q]}}return p}}();hljs.LANGUAGES.cpp=function(){var a={keyword:{"false":1,"int":1,"float":1,"while":1,"private":1,"char":1,"catch":1,"export":1,virtual:1,operator:2,sizeof:2,dynamic_cast:2,typedef:2,const_cast:2,"const":1,struct:1,"for":1,static_cast:2,union:1,namespace:1,unsigned:1,"long":1,"throw":1,"volatile":2,"static":1,"protected":1,bool:1,template:1,mutable:1,"if":1,"public":1,friend:2,"do":1,"return":1,"goto":1,auto:1,"void":2,"enum":1,"else":1,"break":1,"new":1,extern:1,using:1,"true":1,"class":1,asm:1,"case":1,typeid:1,"short":1,reinterpret_cast:2,"default":1,"double":1,register:1,explicit:1,signed:1,typename:1,"try":1,"this":1,"switch":1,"continue":1,wchar_t:1,inline:1,"delete":1,alignof:1,char16_t:1,char32_t:1,constexpr:1,decltype:1,noexcept:1,nullptr:1,static_assert:1,thread_local:1,restrict:1,_Bool:1,complex:1},built_in:{std:1,string:1,cin:1,cout:1,cerr:1,clog:1,stringstream:1,istringstream:1,ostringstream:1,auto_ptr:1,deque:1,list:1,queue:1,stack:1,vector:1,map:1,set:1,bitset:1,multiset:1,multimap:1,unordered_set:1,unordered_map:1,unordered_multiset:1,unordered_multimap:1,array:1,shared_ptr:1}};return{dM:{k:a,i:"</",c:[hljs.CLCM,hljs.CBLCLM,hljs.QSM,{cN:"string",b:"'\\\\?.",e:"'",i:"."},{cN:"number",b:"\\b(\\d+(\\.\\d*)?|\\.\\d+)(u|U|l|L|ul|UL|f|F)"},hljs.CNM,{cN:"preprocessor",b:"#",e:"$"},{cN:"stl_container",b:"\\b(deque|list|queue|stack|vector|map|set|bitset|multiset|multimap|unordered_map|unordered_set|unordered_multiset|unordered_multimap|array)\\s*<",e:">",k:a,r:10,c:["self"]}]}}}();hljs.LANGUAGES.r={dM:{c:[hljs.HCM,{cN:"number",b:"\\b0[xX][0-9a-fA-F]+[Li]?\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\b\\d+(?:[eE][+\\-]?\\d*)?L\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\b\\d+\\.(?!\\d)(?:i\\b)?",e:hljs.IMMEDIATE_RE,r:1},{cN:"number",b:"\\b\\d+(?:\\.\\d*)?(?:[eE][+\\-]?\\d*)?i?\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\.\\d+(?:[eE][+\\-]?\\d*)?i?\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"keyword",b:"(?:tryCatch|library|setGeneric|setGroupGeneric)\\b",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\.\\.\\.",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\.\\.\\d+(?![\\w.])",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\b(?:function)",e:hljs.IMMEDIATE_RE,r:2},{cN:"keyword",b:"(?:if|in|break|next|repeat|else|for|return|switch|while|try|stop|warning|require|attach|detach|source|setMethod|setClass)\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"literal",b:"(?:NA|NA_integer_|NA_real_|NA_character_|NA_complex_)\\b",e:hljs.IMMEDIATE_RE,r:10},{cN:"literal",b:"(?:NULL|TRUE|FALSE|T|F|Inf|NaN)\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"identifier",b:"[a-zA-Z.][a-zA-Z0-9._]*\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"operator",b:"<\\-(?!\\s*\\d)",e:hljs.IMMEDIATE_RE,r:2},{cN:"operator",b:"\\->|<\\-",e:hljs.IMMEDIATE_RE,r:1},{cN:"operator",b:"%%|~",e:hljs.IMMEDIATE_RE},{cN:"operator",b:">=|<=|==|!=|\\|\\||&&|=|\\+|\\-|\\*|/|\\^|>|<|!|&|\\||\\$|:",e:hljs.IMMEDIATE_RE,r:0},{cN:"operator",b:"%",e:"%",i:"\\n",r:1},{cN:"identifier",b:"`",e:"`",r:0},{cN:"string",b:'"',e:'"',c:[hljs.BE],r:0},{cN:"string",b:"'",e:"'",c:[hljs.BE],r:0},{cN:"paren",b:"[[({\\])}]",e:hljs.IMMEDIATE_RE,r:0}]}};
hljs.initHighlightingOnLoad();
</script>


<!-- MathJax scripts -->
<script type="text/javascript" src="https://c328740.ssl.cf1.rackcdn.com/mathjax/2.0-latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>



</head>

<body>
<h1>Stats 155 Class Notes 2012-10-05</h1>

<h1>Main Ideas for Today</h1>

<ol>
<li>The standard deviation, geometrically</li>
<li>Fitting and orthogonality of the residual in high dimensions</li>
<li>\( R^2 \).  Fraction of distance travelled to the response vector, but neglecting the intercept.</li>
<li>Simpson&#39;s paradox</li>
<li>Redundancy</li>
</ol>

<h1>Standard deviation</h1>

<p>We&#39;ve seen the standard deviation in it&#39;s role as describing the width of a distribution. That&#39;s an excellent way to think about the standard deviation.  </p>

<h4>Two rules of thumb for estimating the standard deviation:</h4>

<ul>
<li>The half-width at half height for a bell-shaped distribution</li>
<li>One quarter length of the 95% coverage interval</li>
</ul>

<h4>The arithmetic:</h4>

<p>First, the variance</p>

<ul>
<li>\( s^2 = \frac{1}{n-1} \sum_{i=1}^n (x_i - m)^2 \)</li>
</ul>

<p>Then the standard deviation</p>

<ul>
<li>\( s = \sqrt{s^2} \) &hellip; duh!</li>
</ul>

<h4>The units</h4>

<p>Same as those of the quantity itself</p>

<h4>Geometrically</h4>

<p>Consider the very simple, all-cases-the-same model: <code>x ~ 1</code>  The only &ldquo;explanatory&rdquo; vector is the intercept vector.</p>

<ul>
<li>The coefficient from this model is the grand mean \( m \) of the values \( x \).</li>
<li>The residuals are \( x_i - m \).  The sum of squares of the residual is the square length of the residual vector.</li>
</ul>

<p>New idea: the &ldquo;average per component length&rdquo; of a vector.  This would be useful in describing the typical size of a residual for each case.</p>

<ul>
<li>It might seem obvious that this should just be the length of the vector divided by the dimension of the space in which the vector lives.  But there&#39;s a better way.  The square-length divided by the dimension of the space.  What&#39;s nice about this is that it&#39;s more or less independent of the size of the sample.</li>
</ul>

<p>ACTIVITY:<br/>
Have students fit the all-cases-the-same model to the Galton height data, but with different sample sizes.</p>

<pre><code class="r">runners = fetchData(&quot;Cherry-Blossom-2008.csv&quot;)
nrow(runners)
</code></pre>

<pre><code>## [1] 8787
</code></pre>

<pre><code class="r">small = sample(runners, size = 200)
big = sample(runners, size = 8000)
mod1 = lm(age ~ 1, data = small)
mod2 = lm(age ~ 1, data = big)
# average length per component
sqrt(sum(resid(mod1)^2))/200
</code></pre>

<pre><code>## [1] 0.6931
</code></pre>

<pre><code class="r">sqrt(sum(resid(mod2)^2))/8000
</code></pre>

<pre><code>## [1] 0.1062
</code></pre>

<pre><code class="r"># average square length per component
sum(resid(mod1)^2)/200
</code></pre>

<pre><code>## [1] 96.09
</code></pre>

<pre><code class="r">sum(resid(mod2)^2)/8000
</code></pre>

<pre><code>## [1] 90.21
</code></pre>

<pre><code class="r"># and the square root of that
sqrt(sum(resid(mod1)^2)/200)
</code></pre>

<pre><code>## [1] 9.802
</code></pre>

<pre><code class="r">sqrt(sum(resid(mod2)^2)/8000)
</code></pre>

<pre><code>## [1] 9.498
</code></pre>

<ul>
<li><p>Note that the average square length is consistent between the two sample sizes, but the average legnh is not.  We want our estimates to be about the system under study, not the irrelevant details of the sample we chose to collect.  So the average square length is better.</p></li>
<li><p>But what is the dimension of the space that the residual lives in?  \( n-1 \) since the residual is always orthogonal to the intercept vector.</p></li>
</ul>

<h2>Fitting and orthogonality</h2>

<p>The residuals will be orthogonal to each and every model vector</p>

<pre><code class="r">mod = lm(wage ~ age * educ + exper, data = CPS85)
with(data = CPS85, sum(resid(mod) * exper))
</code></pre>

<pre><code>## [1] -1.02e-12
</code></pre>

<pre><code class="r">with(data = CPS85, sum(resid(mod) * age))
</code></pre>

<pre><code>## [1] -1.458e-12
</code></pre>

<pre><code class="r">with(data = CPS85, sum(resid(mod) * educ))
</code></pre>

<pre><code>## [1] 2.391e-12
</code></pre>

<pre><code class="r">with(data = CPS85, sum(resid(mod) * age * educ))
</code></pre>

<pre><code>## [1] 8.23e-11
</code></pre>

<pre><code class="r"># but not
with(data = CPS85, sum(resid(mod) * exper * educ))
</code></pre>

<pre><code>## [1] -2521
</code></pre>

<h1>Redundancy</h1>

<p>How to make a model say anything you want about A, through redundancy. <br/>
1. Pick a variable B and the coefficient you want on it.<br/>
2. Find other vectors V in whose space the variable B lies. <br/>
3. Fit <code>B ~ V</code><br/>
4. Fit <code>A ~ V</code><br/>
5. Combine the coefficients from (3) and (4) to make a model.</p>

<p>Example: I run a small college and I want to show that wages increase by $2 per hour for every year of education.  Let&#39;s do this with the CPS85 data.</p>

<p>Note first that there is a redundancy in the CPS85 data among age, exper, and educ.  Confirm that<br/>
exper has been estimated in the data as age - (educ+6)</p>

<p>There is one case &mdash; # 350 &mdash; that&#39;s wrong.  It was just an arithmetic mistake in the data.  (Actually, that&#39;s why we&#39;re using these data from 1985.  Anyone who wants to get some modern CPS data is encouraged to do so and will get some extra credit.)</p>

<p>First, let&#39;s work the the corrected data </p>

<pre><code class="r">cps = fetchData(&quot;CPS85-corrected.csv&quot;)
</code></pre>

<pre><code>## Retrieving from http://www.mosaic-web.org/go/datasets/CPS85-corrected.csv
</code></pre>

<p>We already know what the relationship is between experience and age and education: \( educ = age - exper - 6 \)<br/>
Confirm this:</p>

<pre><code class="r">modEduc = lm(educ ~ age + exper, data = cps)
</code></pre>

<p>Now fit a model of wage versus age and experience &hellip;</p>

<pre><code class="r">mod1 = lm(wage ~ age + exper + educ, data = cps)
coef(mod1)
</code></pre>

<pre><code>## (Intercept)         age       exper        educ 
##    -10.4603      0.9260     -0.8208          NA 
</code></pre>

<p>Notice that the software has flagged the redundancy.  Education isn&#39;t playing a role in the model.</p>

<p>One way to characterize the quality of the model is with the typical size of a residual.</p>

<pre><code class="r">sd(resid(mod1))
</code></pre>

<pre><code>## [1] 4.591
</code></pre>

<p>Now I&#39;m going to construct a function that includes education but gives the same model values as the fitted model and therefore has the same size residuals.</p>

<p>To help, here&#39;s a function that&#39;s always zero, reflecting the redundancy among age, experience, education and the intercept:</p>

<pre><code class="r">zero = makeFun(educ - (age - (exper + 6)) ~ educ &amp; age &amp; exper)
</code></pre>

<p>Zero can be added to the model formula without changing anything.  Indeed, you can add 10 times zero without changing anything, or 100 or whatever you like.  Here&#39;s adding 10 times zero</p>

<pre><code class="r">myMod2 = makeFun(-10.46027 + 0.9259656 * age - 0.820833 * exper + 10 * zero(educ, 
    age, exper) ~ educ &amp; age &amp; exper)
</code></pre>

<p>Both these models give exactly the same model values for all the data in the data set:</p>

<pre><code class="r">v2 = with(cps, myMod2(age = age, educ = educ, exper = exper))
sd(fitted(mod1) - v2)
</code></pre>

<pre><code>## [1] 1.157e-05
</code></pre>

<pre><code class="r">mean(fitted(mod1) - v2)
</code></pre>

<pre><code>## [1] -3.634e-05
</code></pre>

<pre><code class="r">sum((fitted(mod1) - v2)^2)
</code></pre>

<pre><code>## [1] 7.768e-07
</code></pre>

<p>Let&#39;s look at the effect of education on wage.  One way to do this is to ask how wage changes with education: a derivative.</p>

<pre><code class="r">effect1 = D(myMod(age = age, educ = educ, exper = exper) ~ educ)
effect2 = D(myMod2(age = age, educ = educ, exper = exper) ~ educ)
effect1(age = 30, exper = 10, educ = 14)
</code></pre>

<pre><code>## Error: could not find function &quot;myMod&quot;
</code></pre>

<pre><code class="r">effect2(age = 30, exper = 10, educ = 14)
</code></pre>

<pre><code>## [1] 10
</code></pre>

<p>According to the 2nd model, education is worth $10 per hour.</p>

<h1>Alignment and Simpson&#39;s Paradox</h1>

<p>By careful choice of covariates, you can influence what the role of the variable is.</p>

<p>Simpson&#39;s paradox, or more generally the dependence of the coefficients of the variables on the covariates, is a simple consequence of alignment.  It&#39;s going to happen, like it or not.</p>

<p>We&#39;ll need more guidance on the choice of covariates.</p>

<p>Approaches we will see:<br/>
1. Use of experimental assignment and randomization to create orthogonality<br/>
2. Analysis of covariance<br/>
3. Causation-related inference.</p>

<h1>The Coefficient of Variation: \( R^2 \)</h1>

<p>How much have we explained &hellip; what fraction of the distance to the response variable have we gone.</p>

<p>BUT &hellip; want to emphasize variance, not the mean.  So we want the fraction orthogonal to the intercept.  We don&#39;t want to give undue credit to something that happens to be aligned with the intercept.</p>

<h1>Geometry of Fitting with Multiple Vectors</h1>

<h3>1. Diagram with two explanatory vectors</h3>

<h3>2. Show that the residual is orthogonal to each and every model vector.</h3>

</body>

</html>

